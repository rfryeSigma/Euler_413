"""
Database of known solutions from several sources:

Jean-Charles Meyrignac  http://euler.free.fr/database.txt
lists 23 solutions for the (4,1,3) pattern

Leonid Durman https://euler413.narod.ru/
update 04/01/2009 lists 27.
http://www3.alpha-net.ne.jp/users/fermat/dioph46e.html

Tito Piezas commenting in
https://math.stackexchange.com/questions/509526/more-elliptic-curves-for-x4y4z4-1
gives 4 by Andrew Bremner.

Tomita in
https://math.stackexchange.com/questions/4853727/on-counterexamples-to-eulers-conjecture-using-bremners-and-durmans-elliptic-c
gives 3+4 more, but one failed.

Several more in
https://math.stackexchange.com/questions/4857229/on-why-solutions-to-x4y4z4-1-come-in-pairs

The final table by Tito Piezas III
https://math.stackexchange.com/questions/1853223/distribution-of-primitive-pythagorean-triples-ppt-and-of-solutions-of-a4b4
has 93 solutions.
"""
from gmpy2 import digits, gcd, is_prime, is_square, isqrt
from math import ceil, prod

# dictionary of 20 known and verified solutions.
# key is {1st letter of info}, {5 digits of d}, '_', 
#   {number of digits in d}
# info is the name of the discoverer and the year in parentheses
# inx is the index in the table by Tito Piezas III
# m is least of the 12 elliptic curve coefficients
# abcd is sorted tuple (a, b, c, d) in a^4 + b^4 + c^4 = d^4
# tuvw tuple (t=a//8, u=b//8, v=(d-c)//2, w=(d+c)//2) where
#    a and b are chosen as even terms, not smallest terms.
known = dict(
F42248_6=dict(info='Frye (1988)', inx=1, m=(-9, 20), #12
	abcd=(95_800, 217_519, 414_560, 422_481),
	tuvw=(11_975, 51_820, 102_481, 320_000),
),
M28130_7=dict(info='MacLeod (1997)', inx=2, m=(-9, 20),
	abcd=(673_865, 1_390_400, 2_767_624, 2_813_001),
	tuvw=(173_800, 345_953, 1_069_568, 1_743_433),
),
B87074_7=dict(info='Bernstein (2001)', inx=3, m=(-29, 12), #3
	abcd=(1_705_575, 5_507_880, 8_332_208, 8_707_481),
	tuvw=(688_485, 1_041_526, 3_500_953, 5_206_528),
),
B12197_8=dict(info='Bernstein (2001)', inx=4, m=(-93, 80), #3
	abcd=(5_870_000, 8_282_543, 11_289_040, 12_197_457),
	tuvw=(733_750, 1_411_130, 1_957_457, 10_240_000),
),
B16003_8=dict(info='Bernstein (2001)', inx=5, m=(-136, 133), #4
	abcd=(4_479_031, 12_552_200, 14_173_720, 16_003_017),
	tuvw=(1_569_025, 1_771_715, 5_761_993, 10_241_024),
),
B16430_8=dict(info='Bernstein (2001)', inx=6, m=(12185, 432), #2
	abcd=(3_642_840, 7_028_600, 16_281_009, 16_430_513),
	tuvw=(455_355, 878_575, 74_752, 16_355_761),
),
E20615_8=dict(info='Elkies (1998)', inx=7, m=(-5, 8), #10
	abcd=(2_682_440, 15_365_639, 18_796_760, 20_615_673),
	tuvw=(335_305, 2_349_595, 2_625_017, 17_990_656),
),
G44310_8=dict(info='Gerbicz (2006)', inx=8, m=(-817, 660), #3
	abcd=(2_164_632, 31_669_120, 41_084_175, 44_310_257),
	tuvw=(270_579, 3_958_640, 1_613_041, 42_697_216),
),
G68711_8=dict(info='Gerbicz (2006)', inx=9, m=(-21021, 9788), #2
	abcd=(10_409_096, 42_878_560, 65_932_985, 68_711_097),
	tuvw=(1_301_137, 5_359_820, 1_389_056, 67_322_041),
),
G11711_9=dict(info='Gerbicz (2006)', inx=10, m=(11846053, 175812), #1
	abcd=(34_918_520, 87_865_617, 106_161_120, 117_112_081),
	tuvw=(4_364_815, 13_270_140, 14_623_232, 102_488_849),
),
R14508_9=dict(info='Rathmann (2006)', inx=11, m=(-361, 540), #2
	abcd=(1_841_160, 121_952_168, 122_055_375, 145_087_793),
	tuvw=(230_145, 15_244_021, 11_516_209, 133_571_584),
),
R15664_9=dict(info='Rathmann (2006)', inx=12, m=(-136, 133), #4
	abcd=(27_450_160, 108_644_015, 146_627_384, 156_646_737),
	tuvw=(3_431_270, 18_328_423, 24_001_361, 132_645_376),
),
T58984_9=dict(info='Tomita (2006)', inx=13, m=(-5, 8),
	abcd=(186_668_000, 260_052_385, 582_665_296, 589_845_921),
	tuvw=(23_333_500, 72_833_162, 164_896_768, 424_949_153),
),
M63852_9=dict(info='MacLeod (1997)', inx=14, m=(-5, 8),
	abcd=(219_076_465, 275_156_240, 630_662_624, 638_523_249),
	tuvw=(34_394_530, 78_832_828, 209_723_392, 428_799_857),
),
G87382_9=dict(info='Gerbicz (2009)', inx=15, m=(-12285, 4112), #2
	abcd=(558_424_440, 606_710_871, 769_321_280, 873_822_121),
	tuvw=(69_803_055, 96_165_160, 133_555_625, 740_266_496),
),
G12597_10=dict(info='Gerbicz (2009)', inx=16, m=(-41, 36), #5
	abcd=(588_903_336, 859_396_455, 1_166_705_840, 1_259_768_473),
	tuvw=(73_612_917, 145_838_230, 200_186_009, 1_059_582_464),
),
T16791_10=dict(info='Tomita (2006)', inx=17, m=(-9, 20),
	abcd=(50_237_800, 632_671_960, 1_670_617_271, 1_679_142_729),
	tuvw=(6_279_725, 79_083_995, 4_262_729, 1_674_880_000),
),
G17878_10=dict(info='Gerbicz (2009)', inx=18, m=(-93, 80), #3
	abcd=(686_398_000, 1_237_796_960, 1_662_997_663, 1_787_882_337),
	tuvw=(85_799_750, 154_724_620, 62_442_337, 1_725_440_000),
),
G18717_10=dict(info='Gerbicz (2009)', inx=19, m=(-865, 592), #3
	abcd=(92_622_401, 1_553_556_440, 1_593_513_080, 1_871_713_857),
	tuvw=(194_194_555, 199_189_135, 889_545_728, 982_168_129),
),
T33936_10=dict(info='Tomita (2007)', inx=20, m=(-5, 8),
	abcd=(664_793_200, 2_448_718_655, 3_134_081_336, 3_393_603_777),
	tuvw=(83_099_150, 391_760_167, 472_442_561, 2_921_161_216),
),
F51790_10=dict(info='Fulea (2024)', inx=21, m=(553, 80), #3
	abcd=(24_743_080, 3_971_389_576, 4_657_804_375, 5_179_020_201),
	tuvw=(3_092_885, 496_423_697, 260_607_913, 4_918_412_288),
),
B12558_11=dict(info='Bremner (2015)', inx=22, m=(233, 60), #3
	abcd=(4_707_813_440, 7_813_353_720, 11_988_496_761, 12_558_554_489),
	tuvw=(588_476_680, 976_669_215, 285_028_864, 12_273_525_625),
),
T15434_11=dict(info='Tomita (2007)', inx=23, m=(-9, 20),
	abcd=(140_976_551, 5_821_981_400, 15_355_831_360, 15_434_547_801),
	tuvw=(727_747_675, 1_919_478_920, 7_646_785_625, 7_787_762_176),
),
T33167_11=dict(info='Tomita (2026)', inx=24, m=(-7752, 205), #3
	abcd=(11_760_180_305, 16_755_328_840, 32_474_980_432, 33_167_450_193),
	tuvw=(2_094_416_105, 4_059_372_554, 10_703_634_944, 22_463_815_249),
),
T39871_11=dict(info='Tomita (2024)', inx=25, m=(-1376, 705), #4
	abcd=(11_262_039_896, 29_676_864_960, 36_295_982_895, 39_871_595_729),
	tuvw=(1_407_754_987, 3_709_608_120, 1_787_806_417, 38_083_789_312),
),
T46055_11=dict(info='Tomita (2024)', inx=26, m=(-41, 36),
	abcd=(18_125_123_544, 34_169_217_200, 41_714_673_255, 46_055_390_617),
	tuvw=(2_265_640_443, 4_271_152_150, 2_170_358_681, 43_885_031_936),
),
P64244_11=dict(info='Piezas (2024)', inx=27, m=(-125, 92), #4
	abcd=(17_111_129_720, 52_289_667_920, 55_479_193_841, 64_244_765_937),
	tuvw=(2_138_891_215, 6_536_208_490, 4_382_786_048, 59_861_979_889),
),
T76973_11=dict(info='Tomita (2024)', inx=28, m=(-1245, 5012), #3
	abcd=(39_110_088_360, 49_796_687_200, 71_826_977_313, 76_973_733_409),
	tuvw=(4_888_761_045, 6_224_585_900, 2_573_378_048, 74_400_355_361),
),
T52108_12=dict(info='Tomita (2024)', inx=29, m=(135, 1208), #2
	abcd=(369_168_502_640, 372_623_278_887, 435_210_480_720, 521_084_370_137),
	tuvw=(46_146_062_830, 54_401_310_090, 74_230_545_625, 446_853_824_512),
),
T59738_12=dict(info='Tomita (2024)', inx=30, m=(-1152, 2345), #2
	abcd=(142_485_966_505, 443_873_167_360, 544_848_079_888, 597_385_645_737),
	tuvw=(55_484_145_920, 68_106_009_986, 227_449_839_616, 369_935_806_121),
),
T82023_12=dict(info='Tomita (2024)', inx=31, m=(-68256, 135125), #1
	abcd=(78_558_599_440, 337_210_257_575, 814_295_112_544, 820_234_293_081),
	tuvw=(9_819_824_930, 101_786_889_068, 241_512_017_753, 578_722_275_328),
),
P10596_13=dict(info='Piezas (2024)', inx=32, m=(-361, 540), #2
	abcd=(187_577_183_625, 535_914_713_672, 1_041_572_957_760, 1_059_621_884_297),
	tuvw=(66_989_339_209, 130_196_619_720, 436_022_350_336, 623_599_533_961),
),
B13671_13=dict(info='Bremner (2015)', inx=33, m=(-56, 165), #3
	abcd=(408_600_530_760, 1_047_978_087_905, 1_226_022_682_752, 1_367_141_947_873),
	tuvw=(51_075_066_345, 153_252_835_344, 159_581_929_984, 1_207_560_017_889),
),
T16823_13=dict(info='Tomita (2024)', inx=34, m=(-1152, 2345), #2
	abcd=(468_405_247_415, 801_719_896_720, 1_657_554_153_472, 1_682_315_502_153),
	tuvw=(100_214_987_090, 207_194_269_184, 606_955_127_369, 1_075_360_374_784),
),
T20517_13=dict(info='Tomita (2024)', inx=35, m=(-29, 12),
	abcd=(125_777_308_440, 894_416_022_327, 2_032_977_944_240, 2_051_764_828_361),
	tuvw=(15_722_163_555, 254_122_243_030, 578_674_403_017, 1_473_090_425_344),
),
T50622_13=dict(info='Tomita (2008)', inx=36, m=(-5, 8),
	abcd=(502_038_853_976, 2_480_452_675_600, 4_987_588_419_655, 5_062_297_699_257),
	tuvw=(62_754_856_747, 310_056_584_450, 37_354_639_801, 5_024_943_059_456),
),
F60140_13=dict(info='Fulea (2024)', inx=37, m=(-97, 400), #2
	abcd=(66_822_832_760, 1_313_903_832_425, 6_010_589_044_544, 6_014_017_311_081),
	tuvw=(8_352_854_095, 751_323_630_568, 2_350_056_739_328, 3_663_960_571_753),
),
T63824_13=dict(info='Tomita (2024)', inx=38, m=(-3168, 1553), #1
	abcd=(613_935_345_969, 2_927_198_165_920, 6_310_500_741_600, 6_382_441_853_233),
	tuvw=(365_899_770_740, 788_812_592_700, 2_884_253_253_632, 3_498_188_599_601),
),
T70823_13=dict(info='Tomita (2024)', inx=39, m=(135, 1208), #2
	abcd=(4_408_757_988_560, 5_611_660_306_848, 5_819_035_124_295, 7_082_388_012_473),
	tuvw=(551_094_748_570, 701_457_538_356, 631_676_444_089, 6_450_711_568_384),
),
P25866_14=dict(info='Piezas (2024)', inx=40, m=(-125, 92),
	abcd=(12_035_933_588_696, 18_776_929_334_105, 23_449_050_222_680, 25_866_132_798_297),
	tuvw=(1_504_491_698_587, 2_931_131_277_835, 3_544_601_732_096, 22_321_531_066_201),
),
F26969_14=dict(info='Fulea (2024)', inx=41, m=(1873, 200), #2
	abcd=(487_814_048_600, 8_528_631_804_200, 26_901_926_181_047, 26_969_608_212_297),
	tuvw=(60_976_756_075, 1_066_078_975_525, 33_841_015_625, 26_935_767_196_672),
),
T27497_14=dict(info='Tomita (2024)', inx=42, m=(-857, 3696), #1
	abcd=(2_054_845_288_320, 19_031_674_138_785, 25_762_744_660_064, 27_497_822_498_977),
	tuvw=(256_855_661_040, 3_220_343_082_508, 4_233_074_180_096, 23_264_748_318_881),
),
T29999_14=dict(info='Tomita (2006)', inx=43, m=(-9, 20),
	abcd=(7_592_431_981_391, 22_495_595_284_040, 27_239_791_692_640, 29_999_857_938_609),
	tuvw=(2_811_949_410_505, 3_404_973_961_580, 11_203_712_978_609, 18_796_144_960_000),
),
T45556_14=dict(info='Tomita (2024)', inx=44, m=(-29, 12),
	abcd=(7_908_038_161_032, 27_546_142_170_735, 43_940_127_884_360, 45_556_888_578_449),
	tuvw=(988_504_770_129, 5_492_515_985_545, 9_005_373_203_857, 36_551_515_374_592),
),
T58844_14=dict(info='Tomita (2024)', inx=45, m=(-1041, 320), #3
	abcd=(26_636_493_544_576, 34_511_786_481_280, 56_329_979_520_665, 58_844_817_090_201),
	tuvw=(3_329_561_693_072, 4_313_973_310_160, 1_257_418_784_768, 57_587_398_305_433),
),
T23079_15=dict(info='Tomita (2024)', inx=46, m=(-1376, 705), #4
	abcd=(32_467_583_677_535, 148_739_531_603_136, 220_093_974_949_320, 230_791_363_907_489),
	tuvw=(18_592_441_450_392, 27_511_746_868_665, 99_161_890_114_977, 131_629_473_792_512),
),
T57364_15=dict(info='Tomita (2008)', inx=47, m=(-9, 20),
	abcd=(130_064_300_991_400, 440_804_942_580_160, 514_818_101_299_289, 573_646_321_871_961),
	tuvw=(16_258_037_623_925, 55_100_617_822_520, 29_414_110_286_336, 544_232_211_585_625),
),
F53807_16=dict(info='Fulea (2024)', inx=48, m=(553, 80),
	abcd=(1_554_532_675_059_625, 1_841_841_620_201_576, 5_352_683_902_805_120, 5_380_742_305_932_201),
	tuvw=(230_230_202_525_197, 669_085_487_850_640, 1_913_104_815_436_288, 3_467_637_490_495_913),
),
T20249_17=dict(info='Tomita (2008)', inx=49, m=(-5, 8),
	abcd=(3_579_087_147_375_440, 14_890_026_433_468_471, 18_565_945_114_216_720, 20_249_506_709_579_721),
	tuvw=(447_385_893_421_930, 2_320_743_139_277_090, 2_679_740_138_055_625, 17_569_766_571_524_096),
),
T62940_17=dict(info='Tomita (2008)', inx=50, m=(-5, 8),
	abcd=(8_813_425_670_440_240, 47_886_740_272_114_976, 56_827_813_308_111_785, 62_940_516_903_410_601),
	tuvw=(1_101_678_208_805_030, 5_985_842_534_014_372, 3_056_351_797_649_408, 59_884_165_105_761_193),
),
F87486_17=dict(info='Fulea (2024)', inx=51, m=(-97, 400),
	abcd=(16_306_696_482_461_560, 21_794_572_772_239_369, 87_375_622_888_246_360, 87_486_470_529_871_881),
	tuvw=(2_038_337_060_307_695, 10_921_952_861_030_795, 32_845_948_878_816_256, 54_640_521_651_055_625),
),
F10311_18=dict(info='Fulea (2024)', inx=52, m=(1873, 200),
	abcd=(4_092_004_076_331_400, 24_975_412_054_750_025, 103_028_409_596_553_328, 103_117_303_193_818_953),
	tuvw=(511_500_509_541_425, 12_878_551_199_569_166, 39_070_945_569_534_464, 64_046_357_624_284_489),
),
P48133_18=dict(info='Piezas (2024)', inx=53, m=(233, 60), #2
	abcd=(225_712_385_669_145_920, 343_651_286_746_207_896, 438_980_913_824_794_665, 481_334_894_209_428_521),
	tuvw=(28_214_048_208_643_240, 42_956_410_843_275_987, 21_176_990_192_316_928, 460_157_904_017_111_593),
),
P15926_19=dict(info='Piezas (2024)', inx=54, m=(-865, 592), #3
	abcd=(208_032_601_069_058_735, 851_144_034_922_098_880, 1_559_028_675_188_874_616, 1_592_672_455_342_770_513),
	tuvw=(106_393_004_365_262_360, 194_878_584_398_609_327, 692_319_927_136_855_889, 900_352_528_205_914_624),
),
B27789_19=dict(info='Bremner (<=2015)', inx=55, m=(-5, 44), #4
	abcd=(585_715_960_903_147_640, 2_024_155_336_530_384_440, 2_556_827_383_749_699_103, 2_778_996_090_487_120_353),
	tuvw=(73_214_495_112_893_455, 253_019_417_066_298_055, 111_084_353_368_710_625, 2_667_911_737_118_409_728),
),
P10816_20=dict(info='Piezas (2024)', inx=56, m=(-817, 660), #3
	abcd=(985_735_303_963_754_488, 8_510_180_374_729_994_520, 9_585_769_407_872_803_575, 10_816_708_329_115_215_113),
	tuvw=(123_216_912_995_469_311, 1_063_772_546_841_249_315, 615_469_460_621_205_769, 10_201_238_868_494_009_344),
),
T20234_20=dict(info='Tomita (2024)', inx=57, m=(-5, 44),
	abcd=(2_329_747_842_666_412_840, 12_696_186_158_476_139_705, 19_399_184_483_902_029_008, 20_234_461_127_553_384_633),
	tuvw=(291_218_480_333_301_605, 2_424_898_060_487_753_626, 3_769_137_484_538_622_464, 16_465_323_643_014_762_169),
),
T77107_20=dict(info='Tomita (2024)', inx=58, m=(-125, 92),
	abcd=(38_320_435_200_564_613_600, 56_375_727_168_307_546_985, 69_320_669_852_667_799_672, 77_107_030_404_994_920_297),
	tuvw=(4_790_054_400_070_576_700, 8_665_083_731_583_474_959, 10_365_651_618_343_686_656, 66_741_378_786_651_233_641),
),
P10178_21=dict(info='Piezas (2024)', inx=59, m=(-9, 20),
	abcd=(21_710_111_037_730_547_416, 54_488_888_702_794_271_560, 99_569_174_129_827_461_335, 101_783_028_910_511_968_041),
	tuvw=(2_713_763_879_716_318_427, 6_811_111_087_849_283_945, 1_106_927_390_342_253_353, 100_676_101_520_169_714_688),
),
B10859_21=dict(info='Bremner (2024)', inx=60, m=(-5, 8),
	abcd=(38_751_631_463_616_255_521, 46_196_947_347_028_916_440, 107_238_802_094_189_542_120, 108_593_344_076_382_641_697),
	tuvw=(5_774_618_418_378_614_555, 13_404_850_261_773_692_765, 34_920_856_306_383_193_088, 73_672_487_769_999_448_609),
),
P20254_21=dict(info='Piezas (2024)', inx=61, m=(22529, 2988), #1
	abcd=(705_558_147_137_161_920, 80_940_380_256_877_627_544, 201_236_910_265_023_650_505, 202_540_855_134_365_138_633),
	tuvw=(88_194_768_392_145_240, 10_117_547_532_109_703_443, 651_972_434_670_744_064, 201_888_882_699_694_394_569),
),
P22874_21=dict(info='Piezas (2024)', inx=62, m=(-56, 165),
	abcd=(84_616_109_521_023_161_865, 163_180_699_054_891_578_792, 210_878_774_189_729_581_880, 228_746_036_963_039_501_833),
	tuvw=(20_397_587_381_861_447_349, 26_359_846_773_716_197_735, 72_064_963_721_008_169_984, 156_681_073_242_031_331_849),
),
P37507_21=dict(info='Piezas (2024)', inx=63, m=(233, 60),
	abcd=(188_195_571_677_171_463_096, 275_897_431_444_390_465_240, 335_981_923_744_570_504_065, 375_075_545_025_537_358_721),
	tuvw=(23_524_446_459_646_432_887, 34_487_178_930_548_808_155, 19_546_810_640_483_427_328, 355_528_734_385_053_931_393),
),
P16716_22=dict(info='Piezas (2024)', inx=64, m=(-817, 660),
	abcd=(655_960_628_418_767_673_472, 1_199_828_498_161_126_807_800, 1_534_990_269_771_364_822_095, 1_671_674_986_261_410_994_097),
	tuvw=(81_995_078_552_345_959_184, 149_978_562_270_140_850_975, 68_342_358_245_023_086_001, 1_603_332_628_016_387_908_096),
),
P27111_22=dict(info='Piezas (2024)', inx=65, m=(-12285, 4112),
	abcd=(1_617_105_485_720_597_938_520, 1_977_857_900_813_232_827_064, 2_376_217_986_337_223_238_735, 2_711_100_675_240_842_912_689),
	tuvw=(202_138_185_715_074_742_315, 247_232_237_601_654_103_383, 167_441_344_451_809_836_977, 2_543_659_330_789_033_075_712),
),
T30374_22=dict(info='Tomita (2024)', inx=66, m=(-5, 44),
	abcd=(444_897_078_221_606_141_840, 2_016_612_085_130_087_009_647, 2_877_363_855_098_380_947_880, 3_037_467_718_844_497_770_129),
	tuvw=(55_612_134_777_700_767_730, 359_670_481_887_297_618_485, 510_427_816_857_205_380_241, 2_527_039_901_987_292_389_888),
),
P40692_22=dict(info='Piezas (2024)', inx=67, m=(-21021, 9788),
	abcd=(842_141_328_509_923_524_200, 2_794_258_267_049_888_616_280, 3_819_055_879_832_290_430_609, 4_069_249_774_250_960_557_713),
	tuvw=(105_267_666_063_740_440_525, 349_282_283_381_236_077_035, 125_096_947_209_335_063_552, 3_944_152_827_041_625_494_161),
),
T96492_22=dict(info='Tomita (2024)', inx=68, m=(-1376, 705),
	abcd=(4_280_294_741_983_707_700_872, 7_599_957_410_902_753_037_705, 8_407_785_501_400_674_212_160, 9_649_219_915_259_253_551_497),
	tuvw=(535_036_842_747_963_462_609, 1_050_973_187_675_084_276_520, 1_024_631_252_178_250_256_896, 8_624_588_663_081_003_294_601),
),
P10739_23=dict(info='Piezas (2024)', inx=69, m=(-56, 165),
	abcd=(772_654_695_228_940_017_240, 6_653_143_628_547_990_852_040, 10_320_518_856_970_101_984_393, 10_739_931_407_728_904_606_857),
	tuvw=(96_581_836_903_617_502_155, 831_642_953_568_498_856_505, 209_706_275_379_401_311_232, 10_530_225_132_349_503_295_625),
),
T11305_23=dict(info='Tomita (2024)', inx=70, m=(-41, 36),
	abcd=(4_141_571_237_269_338_150_920, 7_799_922_278_924_748_599_160, 10_539_980_352_556_633_840_239, 11_305_555_143_522_867_817_873),
	tuvw=(517_696_404_658_667_268_865, 974_990_284_865_593_574_895, 382_787_395_483_116_988_817, 10_922_767_748_039_750_829_056),
),
T12214_23=dict(info='Tomita (2024)', inx=71, m=(2265, 184),
	abcd=(2_120_589_250_533_219_579_335, 7_745_659_501_403_353_894_384, 11_684_173_258_429_439_467_360, 12_214_291_847_502_204_701_241),
	tuvw=(968_207_437_675_419_236_798, 1_460_521_657_303_679_933_420, 5_046_851_298_484_492_560_953, 7_167_440_549_017_712_140_288),
),
T17503_23=dict(info='Tomita (2024)', inx=72, m=(-93, 80),
	abcd=(7_188_470_920_864_810_763_360, 12_896_301_483_090_810_351_440, 15_876_595_946_759_369_395_903, 17_503_689_286_309_573_964_097),
	tuvw=(898_558_865_108_101_345_420, 1_612_037_685_386_351_293_930, 813_546_669_775_102_284_097, 16_690_142_616_534_471_680_000),
),
T18276_23=dict(info='Tomita (2024)', inx=73, m=(-41, 36),
	abcd=(4_780_632_380_106_855_105_975, 13_226_266_181_198_583_365_544, 16_841_033_682_021_117_865_520, 18_276_027_741_543_869_996_617),
	tuvw=(1_653_283_272_649_822_920_693, 2_105_129_210_252_639_733_190, 6_747_697_680_718_507_445_321, 11_528_330_060_825_362_551_296),
),
T24504_23=dict(info='Tomita (2024)', inx=74, m=(-5, 44),
	abcd=(1_519_814_187_310_380_835_480, 13_623_248_018_235_893_097_232, 23_896_480_714_429_616_100_215, 24_504_057_146_788_194_291_849),
	tuvw=(189_976_773_413_797_604_435, 1_702_906_002_279_486_637_154, 303_788_216_179_289_095_817, 24_200_268_930_608_905_196_032),
),
T29998_23=dict(info='Tomita (2024)', inx=75, m=(-1376, 705),
	abcd=(12_036_780_855_644_297_767_488, 23_415_987_016_826_083_521_705, 26_432_693_245_716_083_746_520, 29_998_124_444_432_653_523_113),
	tuvw=(1_504_597_606_955_537_220_936, 3_304_086_655_714_510_468_315, 3_291_068_713_803_285_000_704, 26_707_055_730_629_368_522_409),
),
T25590_23=dict(info='Tomita (2026)', inx=76, m=(-7752, 205),
	abcd=(8_287_230_451_734_009_331_960, 20_438_810_636_735_325_753_008, 22_351_929_166_599_440_578_295, 25_590_155_429_668_179_258_633),
	tuvw=(1_035_903_806_466_751_166_495, 2_554_851_329_591_915_719_126, 1_619_113_131_534_369_340_169, 23_971_042_298_133_809_918_464),
),
T33467_23=dict(info='Tomita (2026)', inx=77, m=(-7752, 205),
	abcd=(5_488_204_013_778_687_062_297, 16_314_446_963_319_764_510_840, 32_977_945_722_604_490_646_760, 33_467_087_559_518_926_108_953),
	tuvw=(2_039_305_870_414_970_563_855, 4_122_243_215_325_561_330_845, 13_989_441_772_870_119_523_328, 19_477_645_786_648_806_585_625),
),
T12017_24=dict(info='Tomita (2024)', inx=78, m=(-9, 20),
	abcd=(30_248_376_090_268_690_676_600, 56_915_898_438_422_390_129_561, 118_508_989_446_504_950_664_160, 120_175_486_227_071_990_769_561),
	tuvw=(3_781_047_011_283_586_334_575, 14_813_623_680_813_118_833_020, 31_629_793_894_324_800_320_000, 88_545_692_332_747_190_449_561),
),
T40984_24=dict(info='Tomita (2024)', inx=79, m=(-136, 133),
	abcd=(168_213_921_178_037_201_816_584, 281_048_473_715_879_152_495_040, 381_461_080_909_525_552_802_665, 409_840_652_625_395_469_143_913),
	tuvw=(21_026_740_147_254_650_227_073, 35_131_059_214_484_894_061_880, 14_189_785_857_934_958_170_624, 395_650_866_767_460_510_973_289),
),
P58702_24=dict(info='Piezas (2024)', inx=80, m=(-865, 592),
	abcd=(179_164_925_544_119_666_072_000, 222_787_467_202_130_880_567_415, 582_653_975_191_641_098_286_104, 587_020_625_514_136_613_276_553),
	tuvw=(22_395_615_693_014_958_259_000, 72_831_746_898_955_137_285_763, 182_116_579_156_002_866_354_569, 404_904_046_358_133_746_921_984),
),
P86474_24=dict(info='Piezas (2024)', inx=81, m=(-1581, 1520),
	abcd=(57_810_716_855_047_169_409_080, 591_519_768_111_748_983_750_888, 812_937_165_464_036_006_213_895, 864_745_895_259_187_110_399_737),
	tuvw=(7_226_339_606_880_896_176_135, 73_939_971_013_968_622_968_861, 25_904_364_897_575_552_092_921, 838_841_530_361_611_558_306_816),
),
P10887_25=dict(info='Piezas (2024)', inx=82, m=(553, 80),
	abcd=(76_399_836_994_875_695_614_145, 842_960_029_363_955_380_661_896, 974_071_910_293_355_929_264_000, 1_088_768_337_585_323_892_067_521),
	tuvw=(105_370_003_670_494_422_582_737, 121_758_988_786_669_491_158_000, 506_184_250_295_224_098_226_688, 582_584_087_290_099_793_840_833),
),
T11718_25=dict(info='Tomita (2024)', inx=83, m=(-9, 20),
	abcd=(59_421_842_165_791_512_201_169, 440_517_744_543_240_750_721_000, 1_165_970_778_032_514_255_823_760, 1_171_867_103_503_245_199_920_081),
	tuvw=(55_064_718_067_905_093_840_125, 145_746_347_254_064_281_977_970, 556_222_630_668_726_843_859_456, 615_644_472_834_518_356_060_625),
),
T17799_25=dict(info='Tomita (2024)', inx=84, m=(-400, 37),
	abcd=(574_585_584_668_340_612_894_713, 1_018_986_340_666_195_845_813_760, 1_724_845_107_301_282_006_322_000, 1_779_979_592_349_189_232_414_713),
	tuvw=(127_373_292_583_274_480_726_720, 215_605_638_412_660_250_790_250, 602_697_003_840_424_309_760_000, 1_177_282_588_508_764_922_654_713),
),
P17968_25=dict(info='Piezas (2024)', inx=85, m=(1000, 47), #1
	abcd=(21_904_850_878_998_429_166_561, 867_970_652_747_799_735_398_360, 1_771_894_249_938_641_198_780_200, 1_796_867_575_393_608_033_006_561),
	tuvw=(108_496_331_593_474_966_924_795, 221_486_781_242_330_149_847_525, 887_481_362_257_304_801_920_000, 909_386_213_136_303_231_086_561),
),
T31228_25=dict(info='Tomita (2024)', inx=86, m=(-1041, 320),
	abcd=(985_329_200_220_584_284_726_784, 1_891_988_836_723_177_605_880_960, 3_003_225_858_017_812_695_181_145, 3_122_849_928_997_768_901_912_409),
	tuvw=(123_166_150_027_573_035_590_848, 236_498_604_590_397_200_735_120, 59_812_035_489_978_103_365_632, 3_063_037_893_507_790_798_546_777),
),
T67140_25=dict(info='Tomita (2024)', inx=87, m=(-9, 20),
	abcd=(1_758_067_984_180_618_846_616_200, 3_057_432_874_236_989_781_768_479, 6_632_467_268_281_371_571_709_360, 6_714_012_701_109_174_954_871_521),
	tuvw=(219_758_498_022_577_355_827_025, 829_058_408_535_171_446_463_670, 1_828_289_913_436_092_586_551_521, 4_885_722_787_673_082_368_320_000),
),
T89973_25=dict(info='Tomita (2024)', inx=88, m=(201, 4), #1
	abcd=(1_749_772_249_172_099_623_115_896, 6_550_300_128_305_909_879_699_935, 8_281_143_989_708_209_432_415_360, 8_997_319_881_974_346_759_473_697),
	tuvw=(218_721_531_146_512_452_889_487, 1_035_142_998_713_526_179_051_920, 1_223_509_876_834_218_439_886_881, 7_773_810_005_140_128_319_586_816),
),
B19874_26=dict(info='Bremner (2024)', inx=89, m=(-5, 8),
	abcd=(5_967_420_362_778_572_362_681_840, 11_389_900_458_885_552_539_102_735, 19_270_755_733_101_284_410_120_384, 19_874_054_816_411_213_708_481_009),
	tuvw=(745_927_545_347_321_545_335_230, 2_408_844_466_637_660_551_265_048, 4_242_077_178_762_830_584_689_137, 15_631_977_637_648_383_123_791_872),
),
T21291_26=dict(info='Tomita (2024)', inx=90, m=(-9, 20),
	abcd=(5_328_636_655_728_999_148_343_576, 10_137_374_115_207_940_432_133_560, 20_991_236_668_646_283_695_879_935, 21_291_952_935_426_564_624_339_201),
	tuvw=(666_079_581_966_124_893_542_947, 1_267_171_764_400_992_554_016_695, 150_358_133_390_140_464_229_633, 21_141_594_802_036_424_160_109_568),
),
B31293_26=dict(info='Bremner (<=2015)', inx=91, m=(-125, 92),
	abcd=(8_089_277_164_034_877_786_318_544, 25_024_939_958_628_554_701_755_145, 27_386_104_940_472_276_169_105_720, 31_293_260_543_726_494_476_580_617),
	tuvw=(1_011_159_645_504_359_723_289_818, 3_423_263_117_559_034_521_138_215, 3_134_160_292_548_969_887_412_736, 28_159_100_251_177_524_589_167_881),
),
T34497_26=dict(info='Tomita (2024)', inx=92, m=(-1245, 5012),
	abcd=(12_209_879_806_944_320_496_330_055, 26_621_272_474_250_391_413_865_480, 30_730_370_351_168_229_154_149_048, 34_497_456_764_264_994_703_368_889),
	tuvw=(3_327_659_059_281_298_926_733_185, 3_841_296_293_896_028_644_268_631, 11_143_788_478_660_337_103_519_417, 23_353_668_285_604_657_599_849_472),
),
T96242_26=dict(info='Tomita (2024)', inx=93, m=(-41, 36),
	abcd=(26_409_847_035_187_091_768_472_744, 47_172_089_378_698_523_207_965_335, 94_680_315_476_024_517_009_462_320, 96_242_977_191_578_497_031_965_033),
	tuvw=(3_301_230_879_398_386_471_059_093, 11_835_039_434_503_064_626_182_790, 24_535_443_906_439_986_911_999_849, 71_707_533_285_138_510_119_965_184),
),
F12318_27=dict(info='Frye (2026)', inx=94, m=(-12065, 12396),
	abcd=(62_831_773_759_131_557_571_594_880, 66_491_673_395_168_374_249_746_120, 118_194_421_251_475_239_056_505_903, 123_188_180_833_923_372_056_627_153),
	tuvw=(7_853_971_719_891_444_696_449_360, 8_311_459_174_396_046_781_218_265, 2_496_879_791_224_066_500_060_625, 120_691_301_042_699_305_556_566_528),
),
B13314_27=dict(info='Bremner (2024)', inx=95, m=(-5, 8),
	abcd=(41_328_162_329_293_632_574_512_440, 74_522_041_242_387_759_937_530_799, 129_410_861_225_043_592_041_256_520, 133_140_691_304_639_620_846_181_457),
	tuvw=(5_166_020_291_161_704_071_814_055, 16_176_357_653_130_449_005_157_065, 29_309_325_031_125_930_454_325_329, 103_831_366_273_513_690_391_856_128),
),
F17408_27=dict(info='Frye (2026)', inx=96, m=(-136, 133),
	abcd=(46_402_888_024_739_111_034_420_161, 92_419_682_545_114_696_981_174_360, 170_289_556_324_371_670_328_363_560, 174_088_703_841_632_292_189_275_073),
	tuvw=(11_552_460_318_139_337_122_646_795, 21_286_194_540_546_458_791_045_445, 63_842_907_908_446_590_577_427_456, 110_245_795_933_185_701_611_847_617),
),
P22752_27=dict(info='Piezas (2024)', inx=97, m=(-9, 20),
	abcd=(2_650_718_685_573_298_353_948_640, 85_818_832_944_459_457_142_858_489, 226_369_052_354_324_181_334_408_840, 227_529_118_288_906_398_066_378_489),
	tuvw=(331_339_835_696_662_294_243_580, 28_296_131_544_290_522_666_801_105, 70_855_142_672_223_470_461_760_000, 156_673_975_616_682_927_604_618_489),
),
P45283_27=dict(info='Piezas (2024)', inx=98, m=(12185, 432),
	abcd=(10_453_265_194_894_185_904_695_360, 145_561_707_582_919_191_804_801_464, 451_622_371_501_239_854_889_723_705, 452_835_938_257_547_709_708_389_177),
	tuvw=(1_306_658_149_361_773_238_086_920, 18_195_213_447_864_898_975_600_183, 606_783_378_153_927_409_332_736, 452_229_154_879_393_782_299_056_441),
),
F50406_27=dict(info='Frye (2026)', inx=99, m=(-1245, 5012),
	abcd=(106_958_136_069_417_067_994_530_335, 411_177_854_471_028_470_696_556_192, 435_117_527_990_435_060_232_042_280, 504_068_891_841_730_072_306_483_681),
	tuvw=(51_397_231_808_878_558_837_069_524, 54_389_690_998_804_382_529_005_285, 198_555_377_886_156_502_155_976_673, 305_513_513_955_573_570_150_507_008),
),
F91831_27=dict(info='Frye (2026)', inx=100, m=(-1041, 320),
	abcd=(250_530_677_254_015_598_463_660_440, 535_607_712_470_322_407_570_378_200, 889_106_559_932_545_369_165_762_471, 918_310_142_223_097_801_006_397_529),
	tuvw=(31_316_334_656_751_949_807_957_555, 66_950_964_058_790_300_946_297_275, 14_601_791_145_276_215_920_317_529, 903_708_351_077_821_585_086_080_000),
),
)
"""
"""

def make_known(verbose: bool=True):
    """
    Verify known table.
    Report or add a potential new field.
    If v: copy new table entries.
    """
    for p_inx, (key, val) in enumerate(known.items(), start=1):
        if isinstance(val, tuple):
            assert 2 == len(val), f'{p_inx}, {key}, {val}'
            assert isinstance(val[0], tuple), f'{p_inx}, {key}, {val}'
            assert isinstance(val[1], str), f'{p_inx}, {key}, {val}'
            info = val[1]
            a, b, c, d = abcd = sorted(val[0])
        elif isinstance(val, dict):
            info = val['info']
            a, b, c, d = abcd = val['abcd']
        assert verify_abcd(abcd, False), f'{abcd}'
        key2 = make_key(info, d)
        t, u, v, w = tuvw = make_tuvw(abcd)
        assert verify_tuvw(abcd, tuvw)
        m = tuvw_to_u_list(tuvw)

        # Opional output modified entry
        if not verbose: continue
        print(f"{key2}=dict(info='{info}', inx={p_inx}, m={tuple(m[:2])},"
              f"\n\tabcd=({a:_}, {b:_}, {c:_}, {d:_}),"
              f"\n\ttuvw=({t:_}, {u:_}, {v:_}, {w:_}),"
              "\n),")

# dictionary of known, but too long to use solutions
too_long = dict(

T16774_28=dict(info='Tomita (2006)',
    abcd=(169_218_021_322_170_204_480_680_305, 1_288_056_982_586_427_591_062_203_384, 1_507_524_066_882_038_472_584_786_800, 1_677_479_490_238_223_823_661_446_513), # ###
    tuvw=(161007122823303448882775423, 188440508360254809073098350, 754130734458026809590383104, 923348755780197014071063409),
),
E91617_71=dict(info='Elkies (1988)',
                     abcd=
          (1439965710648954492268506771833175267850201426615300442218292336336633, 
           4417264698994538496943597489754952845854672497179047898864124209346920, 
           9033964577482532388059482429398457291004947925005743028147465732645880, 
           9161781830035436847832452398267266038227002962257243662070370888722169),
	),
)

# notes on supposed solutions that fail tests
failures = dict( 
) # discarded many supposed solutions that didn't get past modulo 1000.
"""
I hope to repair some of these, by extending digits modulo 10^n, 2^n.

Elkies (Rank 3)$D \approx 1.37 \times 10^{15}
(1_215_841_556_929_180, 1_223_656_069_451_200, 1_304_393_310_401_241, 1_378_428_811_801_811)
FAIL

Bremner (Large Quartet)$D \approx 2.02 \times 10^{18}
(430_948_011_105_472_360, 1_607_419_006_206_857_120, 1_768_582_365_049_504_561, 2_021_574_801_364_575_001)
FAIL

Bremner (2015)$D \approx 2.77 \times 10^{18}
(1_008_189_451_101_241_100, 1_811_852_551_121_555_540, 2_410_480_111_114_141_501, 2_773_222_096_396_666_501)
FAIL
revised
Bremner (2.77e18),
(1_514_213_004_105_420, 2_166_227_105_264_160, 2_347_787_002_185_501, 2_773_222_096_396_666_501)
FAIL

Bremner (1.80e15),
(930_121_902_176_120, 1_180_958_740_490_560, 1_496_220_137_921_841, 1_806_634_845_984_321)
FAIL


T24504_23
abcd=(
1519814187310380835480, 
3896480714429616100215, 
13623248018235893097232, 
24_504_057_146_788_194_291_849)

>>> e=26; M=10**e; (a**4 + b**4 + c**4)%M; (d**4)%M; (a%M, b%M, c%M, d%M)
40330521838826747961117601
10330521838826747961117601
(1519814187310380835480, 3896480714429616100215, 13623248018235893097232, 24504057146788194291849)

"""
def make_tuvw(abcd: tuple) -> tuple:
    """Generate tuvd from abcd
    """
    a, b, c, d = abcd
    assert 0 < a < b < c < d
    assert d % 2 > 0, f'd'
    tu = [x for x in abcd[:-1] if x % 2 == 0]
    assert tu[0] % 8 == 0 and tu[1] % 8 == 0, f'tu'
    t = tu[0] // 8
    u = tu[1] // 8
    cc = next(x for x in abcd[:-1] if x % 2 > 0)
    v = (d - cc) // 2
    w = (d + cc) // 2
    return t, u, v, w
    
def verify_tuvw(abcd: tuple, tuvw: tuple) -> bool:
    """Check tuvw matches abcd
    """
    a, b, c, d = abcd
    t, u, v, w = tuvw
    assert 0 < t < u and 0 < v < w, f'{tuvw}'
    assert v % 2**9 == 0 or w % 2**9 == 0, f'{tuvw}, {v%2**9}, {w%2**9}'
    cc = next(x for x in abcd[:-1] if x % 2 > 0)
    assert d == w + v and cc == w - v, f'{tuvw}, {d}, {cc}'
    M = d**4 - cc**4
    assert t**4 + u**4 == M // 2**12, f'{tuvw}, {M}, {t**4 + u**4}'
    assert M // 2**3 == v * w**3 + w * v**3, f'{tuvw}, {M}'
    return True

def verify_abcd(abcd: tuple, verbose: bool=True) -> bool:
    """Check solution a^4 + b^4 + c^4 == d^4.
    """
    a, b, c, d = abcd
    assert 0 < a <= b <= c <= d, f'{abcd}'
    assert gcd(a, b, c, d) == 1, f'gcd(a, b, c, d)'
    lhs = a ** 4 + b ** 4 + c ** 4
    rhs = d ** 4
    if lhs == rhs:
        if verbose: print(f'Match {int(rhs):_}')
        return True
    else:
        if verbose: print(f'FAIL\n{int(lhs):_}\n{int(rhs):_}')
        return False

def fix_abcd(abcd: tuple) -> bool:
    """Try combinations of a, b, c, d for a 4th power
    """
    a, b, c, d = abcd
    assert 0 < a <= b <= c <= d, f'{abcd}'
    assert gcd(a, b, c, d) == 1, f'gcd(a, b, c, d)'
    a4, b4, c4, d4 = abcd4 = [x**4 for x in abcd]
    test = a4 + b4 + c4
    if test == d4:
        print(f'a^4 + b^4 + c^4 == d^4 {abcd}')
        return True
    if is_square(test):
        root = isqrt(test)
        if is_square(root):
            fix = isqrt(root)
            print(f'Replace d {d} with {fix}')
            return True
    for inx_out in range(3):
        test = d4 - sum([x4 for i, x4 in enumerate(abcd4[:-1]) if i != inx_out])
        if is_square(test):
            root = isqrt(test)
            if is_square(root):
                fix = isqrt(root)
                print(f'Replace {'abc'[inx_out]} {abcd[inx_out]} with {fix}')
                return True
    return False

def verify_abcd_modulo_10(solution: tuple) -> int:
    """Check solution at successive powers of 10.
    """
    a, b, c, d = solution
    assert max(a, b, c) <= d
    d4 = d ** 4
    e = 1
    modulus = 10
    while True:
        lhs = (pow(a, 4, modulus) + pow(b, 4, modulus) + pow(c, 4, modulus)) % modulus
        rhs = pow(d, 4, modulus)
        print(e, modulus, lhs, rhs)
        if lhs != rhs:
            print(f'{e} fail')
            return e
        if rhs >= d4:
          print('All powers pass')
          return e
        e += 1
        modulus *= 10

def make_key(info: str, d: int) -> str:
    """Generate dict key for a solution.
    The key descibes the entry info and d as "Lxyz_n, 
    where L is the first letter of info,
    xyz are first five digits of d,
    and n is number of digits of d"
    """
    L = info[0]
    assert L.isalpha(), f'{info}, {d}'
    digs = digits(d)
    key = L + digs[:5] + '_' + str(len(digs))
    return key

def verify_key(key: str, info: str, d: int) -> bool:
    if not info.startswith(key[0]):
        import pdb; pdb.set_trace()
    assert info.startswith(key[0])
    digs, num = str(key[1:]).split('_')
    n = eval(num)
    assert eval(digs) == d // 10**(n - 5)
    return True

def make_m(abcd: tuple) -> tuple:
    """Given solution, calculate characteristic Rational m
    But to find small rationals, you have to permute and change signs.
    """
    a, b, c, d = abcd
    #assert 0 < a <= b <= c <= d, f'{abcd}'
    assert gcd(a, b, c, d) == 1, f'gcd(a, b, c, d)'
    a4, b4, c4, d4 = [x**4 for x in abcd]
    assert a4 + b4 + c4 == d4
    m_num = a*a + 2*a*b + b*b - c*c - d*d
    m_den = a*a + a*b + b*b + (a + b) * d
    g = int(gcd(m_num, m_den))
    # Sometimes, both negative produces different results than both positive
    #if m_num < 0 and m_den < 0:
    #    m_num, m_den = - m_num, - m_den
    return m_num // g, m_den // g, g

def tuvw_to_u_list(tuvw: tuple, verbose: bool=False) -> tuple:
    """Convert (t, u, v, w) to 12 unique u 
    Return u with greatest gcd divided out.
    """
    t, u, v, w = tuvw
    assert 0 < t < u and 0 < v < w, f'{tuvw}'
    assert v % 2**9 == 0 or w % 2**9 == 0, f'{tuvw}, {v%2**9}, {w%2**9}'
    a, b, c, d = 8 * t, 8 * u, w - v, w + v
    if verbose: print(a, b, c, d)
    best = [0]*3
    i = 0
    for sa in (a, -a):
        for sb in (b, -b):
            for sc in (c, -c):
                for aa, bb, cc in ((sa, sb, sc), (sa, sc, sb), (sb, sc, sa)):
                    i += 1
                    if i in {4, 8, 10, 11, 15, 16, 18, 20, 21, 22, 23, 24}:
                        continue # duplicate
                    r = make_m((aa, bb, cc, d))
                    if verbose: print(r)
                    if r[-1] > best[-1]: best = r
    return tuple(map(int, best))
    



# This is how p_max is estimated:
# p_max is an estimate of the max prime needed for solve.
# t^4 + b^4 = m; 2^9 * m = w * v^3  + v * w^3 = x * (y^3 + x^2 * y)
# p_max is when x is w and is prime.
# [ceil(w / v) for val in solutions.known.values() for v, w in [val['tuvw'][2:]]]
#  = [4, 2, 2, 6, 2, 219, 7, 27, 49, 8, 12, 6, 3, 3, 6, 6, 393, 28, 2, 2]
# Select r = 2 as an initial low estimate estimate of the ratio.
# 2^9 * m = w * v^3 + v w^3 ~= w^4 * (1/r^3 + 1/r)
# The solver builds LHS of x starting with 2^9.
# 2^9 * m > (2^9 * p_max)^4 * (1/r^3 + 1/r)
# p_max < 2*-6 * (m * (r^3)/(1 + r^2) * 2^-3)^(1/4)
def estimate_max_prime():
    """Estimate largest prime needed to factor known solutions.
    """
    for key, val in known.items():
        # Extract entry
        t, u, v, w = tuvw = val['tuvw']
        v_evens = val['v_evens']
        v_primes = val['v_primes']
        w_evens = val['w_evens']
        w_primes = val['w_primes']

        # Calculate p_max
        m = t**4 + u**4
        r = 2
        # p_max < 2*-6 * (m * (r^3)/(1 + r^2) * 2^-3)^(1/4)
        p_max = ceil(2**-6 * (m * r**3 * (1 + r*r)**-1)**(1/4))
        print(key, f'{p_max:_}'
              f'\n\tv: {v_evens}, {v_primes}'
              f'\n\tw: {w_evens}, {w_primes}')
"""
This is the output for the 10 and 14 digit solutions with comments
G12597_10 2_603_455 # Just enough for the worst case
	v: 1, {89: 1, 2249281: 1}
	w: 512, {2069497: 1}
T16791_10 1_389_771
	v: 1, {41: 1, 103969: 1}
	w: 1024, {5: 4, 2617: 1}
G17878_10 2_781_118
	v: 1, {1097: 1, 56921: 1}
	w: 8192, {5: 4, 337: 1}
G18717_10 4_111_487
	v: 1024, {868697: 1}
	w: 1, {982168129: 1}
T29999_14 65_831_370_305
	v: 1, {11203712978609: 1}
	w: 512, {5: 4, 41: 1, 89: 1, 16097: 1}

tree1_18 has primes 17 thru 7_766_713
Maximum prime in 20 indexes at level 12 is
>>> factoring.tree1[0][20 * 2**12 - 1]
4_686_281
which is more than the penultimate estimate.

The final T29999_14 estimate is not practical,
but the factors needed all happen to be small.
"""

def solve_all():
    """Solve all known solutions.
    """
    from logging_413 import V, IntFlag
    from factoring import factor_tu
    from solving import solve_factors
    from time import time
    start = time()
    nones = 0
    for key, val in known.items():
        t, u, v, w = tuvw = val['tuvw']
        print(f'{key}: tuvw=({t:_}, {u:_}, {v:_}, {w:_}),')
 
        common, factors, others = factor_tu(t, u, vV=V.NONE)
        cp = (f'{int(k):_}: {e}' for k, e in common.items())
        fp = (f'{int(k):_}: {e}' for k, e in factors.items())
        of = (f'{int(k):_}: {e}' for k, e in others.items())
        print(f"\tcommon={{{', '.join(map(str, cp))}}},")
        print(f"\tfactors={{{', '.join(map(str, fp))}}},")
        print(f"\tothers={{{', '.join(map(str, of))}}},")

        sol = solve_factors(common, factors, others, vV=V.NONE)
        if sol is None:
            nones += 1
            print('\tNo solution')
        else:
            s1, s2 = map(int, sol)
            print(f'\tsolution: ({s1:_}, {s2:_})')
    elapsed = time() - start
    print(f'Missed {nones} / {len(known)}, Elapsed: {elapsed:.6f}s')
"""
This is an extract of the output:
F42248_6: tuvw=(11_975, 51_820, 102_481, 320_000),
	common={5: 1},
	factors={102_481: 1, 26_777: 1, 4_216_393: 1},
	others={},
	solution: (102_481, 320_000)

First failure:
T76973_11: tuvw=(4_888_761_045, 6_224_585_900, 2_573_378_048, 74_400_355_361),
	common={5: 1},
	factors={5_715_497: 1, 17: 1, 89: 1, 1_009: 1, 1_889: 1, 47_881: 1},
	others={4_201_638_018_991_321: 1},
	No solution # needed factor(v) = 2^9 * 5_026_129, and w worse
More:
P10596_13: tuvw=(66_989_339_209, 130_196_619_720, 436_022_350_336, 623_599_533_961),
	common={},
	factors={15_889: 1},
	others={19_351_760_128_566_677_458_870_822_099_259_343_016_849: 1},
	No solution # Needed v = 2^9 * 851606153, and w worse
T20517_13: tuvw=(15_722_163_555, 254_122_243_030, 578_674_403_017, 1_473_090_425_344),
	common={5: 1},
	factors={73: 1, 193: 1, 449: 1},
	others={1_054_801_055_124_988_279_593_533_007_158_131_817: 1},
	No solution # Needed w = 2^9 * 2_877_129_737, and v worse
P25866_14: tuvw=(1_504_491_698_587, 2_931_131_277_835, 3_544_601_732_096, 22_321_531_066_201),
	common={},
	factors={2: 1, 577: 1, 14_401: 1, 2_324_513: 1},
	others={2_043_405_818_879_010_681_860_021_331_789_194_993: 1},
	No solution # Needed v = 2^10 * 577 * 5_999_177, and w worse
T23079_15: tuvw=(18_592_441_450_392, 27_511_746_868_665, 99_161_890_114_977, 131_629_473_792_512),
	common={3: 1},
	factors={5_292_756_361: 1, 113: 1, 4_057: 1},
	others={3_522_879_270_244_801_675_029_516_727_833_255_041: 1},
	No solution
F53807_16: tuvw=(230_230_202_525_197, 669_085_487_850_640, 1_913_104_815_436_288, 3_467_637_490_495_913),
	common={7: 1},
	factors={118_033: 1, 17: 1, 193: 1, 1_033: 1},
	others={211_577_974_553_099_948_247_831_989_379_670_699_465_696_009: 1},
	No solution
T62940_17: tuvw=(1_101_678_208_805_030, 5_985_842_534_014_372, 3_056_351_797_649_408, 59_884_165_105_761_193),
	common={2: 1},
	factors={17_497: 1, 15_473: 1},
	others={296_716_077_430_840_069_798_984_008_902_785_987_969_738_109_839_143_961: 1},
	No solution
P15926_19: tuvw=(106_393_004_365_262_360, 194_878_584_398_609_327, 692_319_927_136_855_889, 900_352_528_205_914_624),
	common={},
	factors={97_481_617: 1, 41: 1, 73: 1, 241: 1, 1_993: 1, 13_217: 1, 37_097: 1},
	others={22_855_673_902_133_558_003_423_009_789_910_576_443_809_153: 1},
	No solution
And failures become more common for bigger entries.
Missed 41 / 93, Elapsed: 0.515782s
"""
